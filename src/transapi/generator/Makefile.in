PKGNAME = @PROJECTNAME@
TARGETS = @PROJECTNAME@.so

# Various configurable paths (remember to edit Makefile.in, not Makefile)
prefix = @prefix@
exec_prefix = @exec_prefix@
datarootdir = @datarootdir@
datadir = @datadir@
bindir = @bindir@
includedir = @includedir@
libdir =  @libdir@
mandir = @mandir@

CC = @CC@
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@
INSTALL_DATA = @INSTALL_DATA@
LIBS = @LIBS@
CFLAGS = @CFLAGS@
CPPFLAGS = @CPPFLAGS@

SRCS = @PROJECTNAME@.c
OBJS = $(SRCS:%.c=%.o)

all: $(TARGETS)

$(TARGETS): $(OBJS)
	$(CC) --shared $(LIBS) $(OBJS) -o $@;

$(OBJDIR)/%.o: %.c
	@[ -d $$(dirname $@) ] || \
		(mkdir -p $$(dirname $@))
	$(CC) $(CFLAGS) $(CPPFLAGS) -fPIC -c $< -o $@

.PHONY: install
install: $(TARGETS)
	[ -d $(DESTDIR)/$(libdir) ] || \
	    (mkdir -p $(DESTDIR)/$(libdir); chmod 755 $(DESTDIR)/$(libdir))
	$(INSTALL_PROGRAM) $(TARGETS) $(DESTDIR)/$(libdir)/;

.PHONY: clean
clean:
	rm -rf $(TARGETS) $(OBJS)

